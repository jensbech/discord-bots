services:
  discord-bored-bot:
    image: jensbech/bored-bot:latest
    container_name: discord-bored-bot
    restart: unless-stopped
    environment:
      - DISCORD_BOT_TOKEN=${DISCORD_BOT_TOKEN:?DISCORD_BOT_TOKEN is required but not set}
      - APPLICATION_ID=${APPLICATION_ID:?APPLICATION_ID is required but not set}
      - BOOKSTACK_BASE_URL=${BOOKSTACK_BASE_URL:?BOOKSTACK_BASE_URL is required but not set}
      - BOOKSTACK_API_ID=${BOOKSTACK_API_ID:?BOOKSTACK_API_ID is required but not set}
      - BOOKSTACK_API_KEY=${BOOKSTACK_API_KEY:?BOOKSTACK_API_KEY is required but not set}
      - BOOKSTACK_GUILD_ID=${BOOKSTACK_GUILD_ID:-}
      - OPENAI_API_KEY=${OPENAI_API_KEY:?OPENAI_API_KEY is required but not set}

      - Logging__LogLevel__Default=Information
      - Logging__LogLevel__Microsoft=Warning
      - Logging__LogLevel__Microsoft.Hosting.Lifetime=Information

      - TZ=Oslo/Europe

    healthcheck:
      test:
        [
          "CMD",
          "ps",
          "aux",
          "|",
          "grep",
          "DiscordBots.BoredBot.dll",
          "|",
          "grep",
          "-v",
          "grep",
        ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
